---
date: 2005-07-10 08:09:14+00:00
layout: post
title: 自宅でグローバルアドレスの動的取得
tags:
- コンピュータ＆ネットワーク
language:
- 日本語
---

私が5年前にマンションを購入する際に、「部屋に光を引き込むこと」と「各部屋にはEthernetの口を設けること」というのを条件にしました。というわけで、現在、各部屋数箇所ずつ、計19箇所にRJ45の口が出ており、すべて22mm管で配管してあります。クローゼットにはそれらの配管を集約するスペースが作ってあり、19"ラック（背の低い奴）が入っていて、パッチパネルで配線を自由に切り替えられるようになっています。

ここまでは先見の明があったと自分でも思うのですが、一つ甘かったな、と思うのは、管にケーブルを1本ずつしか敷設しなかったことです。19箇所あれば十分であろう、と思っていたのですが、たしかに19もの端末をつなぐことはあり得ないのですが、場所によっては一箇所に2～3台の端末を繋ぎたくなるケースがあるのです。特に私の書斎などはコンピュータがゴロゴロしているので、そうなると一箇所のローゼットに繋ぎたい端末が2台以上出てきてしまいます。

単に複数繋ぎたいだけなら、手元にハブ置いてやればいいわけで、はなはだ美しくないものの、これまではそうしてしのいできました。ただ、これでも解決できないのが、グローバル・プライベートアドレス問題です。基本的には家の端末はプライベートアドレス空間にあり、NAT越しで使っているわけですが、たまにグローバルが欲しくなることがあります。

私は/29のグローバルアドレスをくれるISPに加入していますので、空いているグローバルアドレスはあるのですが、グローバル使いたいたびにパッチパネルを操作するのも面倒ですし、先ほどのように一箇所に2台以上の端末がいて、それらのアドレスをグローバルとプライベートで混在させたい、となるともうお手上げなわけです。せめて一つの管に2本ケーブルが配線してあれば、一つをグローバル、一つをプライベート、のようにできたんでしょうけど、当時はそんな使い方思いもしなかったので…^_^;

で、（前からやろうやろうとは思っていたのですが）、使っていないグローバルを各端末にPPPoEで配ってあげる、ことにしました。グローバルにつながっているFreeBSDマシンをPPPoEのAccess Concentratorとして動作させ、他の端末でグローバルが欲しい時にだけ、このFreeBSDマシンにPPPoEしてグローバルを貰うようにするわけです。proxyarpしてやれば、同じセグメントのアドレス配れます。グローバル使わない時はプライベート空間にいるので比較的安心ですし、なにより物理的なケーブル操作なしでグローバルとプライベートを随時使い分けられるので大変便利です。

たまたま今回はUNIXマシンで実現しましたが、こういうニーズって結構あるはずだと思うんですよね。ブロードバンドルーターで同じ機能を実現すれば、けっこう受けるように思うんですけど…。それとももうあるのかしらん？
